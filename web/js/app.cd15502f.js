(function(t){function e(e){for(var r,a,s=e[0],i=e[1],u=e[2],l=0,d=[];l<s.length;l++)a=s[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);f&&f(e);while(d.length)d.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var t,e=0;e<c.length;e++){for(var n=c[e],r=!0,a=1;a<n.length;a++){var s=n[a];0!==o[s]&&(r=!1)}r&&(c.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},o={app:0},c=[];function s(t){return i.p+"js/"+({}[t]||t)+"."+{"chunk-00232c79":"e92d83e4","chunk-46007864":"acfe40d0","chunk-70237052":"822f6543","chunk-7dd641a2":"23f02f19"}[t]+".js"}function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(t){var e=[],n={"chunk-00232c79":1,"chunk-46007864":1,"chunk-70237052":1,"chunk-7dd641a2":1};a[t]?e.push(a[t]):0!==a[t]&&n[t]&&e.push(a[t]=new Promise((function(e,n){for(var r="css/"+({}[t]||t)+"."+{"chunk-00232c79":"d0e69ee8","chunk-46007864":"1550ee09","chunk-70237052":"b5817c1f","chunk-7dd641a2":"1550ee09"}[t]+".css",o=i.p+r,c=document.getElementsByTagName("link"),s=0;s<c.length;s++){var u=c[s],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===o))return e()}var d=document.getElementsByTagName("style");for(s=0;s<d.length;s++){u=d[s],l=u.getAttribute("data-href");if(l===r||l===o)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var r=e&&e.target&&e.target.src||o,c=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=r,delete a[t],f.parentNode.removeChild(f),n(c)},f.href=o;var p=document.getElementsByTagName("head")[0];p.appendChild(f)})).then((function(){a[t]=0})));var r=o[t];if(0!==r)if(r)e.push(r[2]);else{var c=new Promise((function(e,n){r=o[t]=[e,n]}));e.push(r[2]=c);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.src=s(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(f);var n=o[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",d.name="ChunkLoadError",d.type=r,d.request=a,n[1](d)}o[t]=void 0}};var f=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var f=l;c.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"02ab":function(t,e,n){"use strict";n("8dd6")},"27c9":function(t,e,n){},3695:function(t,e,n){"use strict";n("f9ed")},4360:function(t,e,n){"use strict";var r,a=n("2b0e"),o=n("2f62"),c=(n("b0c0"),{token:function(t){return t.user.token},uid:function(t){return t.user.uid},name:function(t){return t.user.name},avatar:function(t){return t.user.avatar}}),s=c,i=(n("d3b7"),n("498a"),n("ade3")),u=n("c24f"),l=n("5f87"),d="RESET_STATE",f="SET_TOKEN",p="SET_NAME",m="SET_AVATAR",h="SET_UID",b=function(){return{token:Object(l["a"])(),uid:-1,name:"",avatar:""}},v=(r={},Object(i["a"])(r,d,(function(t){Object.assign(t,b())})),Object(i["a"])(r,f,(function(t,e){t.token=e})),Object(i["a"])(r,p,(function(t,e){t.name=e})),Object(i["a"])(r,m,(function(t,e){t.avatar=e})),Object(i["a"])(r,h,(function(t,e){t.uid=e})),r),g={login:function(t,e){var n=t.commit,r=e.username,a=e.password;return new Promise((function(t,e){Object(u["c"])({username:r.trim(),password:a}).then((function(e){var r=e.data;n(f,r),Object(l["c"])(r),t()})).catch((function(t){e(t)}))}))},getInfo:function(t){var e=t.commit;return new Promise((function(t,n){Object(u["a"])().then((function(r){var a=r.data,o=r.code;a&&401!==o||n(new Error("Verification failed, please Login again."));var c=a.uid,s=a.nickname,i=a.avatar;e(h,c),e(p,s),e(m,i),t(a)})).catch((function(t){n(t)}))}))},logout:function(t){var e=t.commit;return new Promise((function(t){e(d),Object(l["b"])(),t()}))}},k={namespaced:!0,state:b(),mutations:v,actions:g};a["default"].use(o["a"]);e["a"]=new o["a"].Store({modules:{user:k},getters:s})},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=n("5c96"),o=n.n(a),c=(n("a83d"),n("f5df1"),n("27c9"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)}),s=[],i=(n("5c0b"),n("2877")),u={},l=Object(i["a"])(u,c,s,!1,null,null,null),d=l.exports,f=(n("d3b7"),n("8c4f")),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"dashboard"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:5}},[n("el-card",{attrs:{"body-style":{padding:"0px"}}},[n("div",{staticClass:"status-wrapper"},[n("div",{staticClass:"status-icon",staticStyle:{"background-color":"#909399"}},[n("i",{staticClass:"el-icon-user-solid"})]),n("div",{staticClass:"status-number"},[n("div",{staticStyle:{color:"#909399"}},[t._v(t._s(t.status.userCount))]),n("div",[t._v("用户总数")])])])])],1),n("el-col",{attrs:{span:5}},[n("el-card",{attrs:{"body-style":{padding:"0px"}}},[n("div",{staticClass:"status-wrapper"},[n("div",{staticClass:"status-icon",staticStyle:{"background-color":"#67c23a"}},[n("i",{staticClass:"el-icon-house"})]),n("div",{staticClass:"status-number"},[n("div",{staticStyle:{color:"#67c23a"}},[t._v(t._s(t.status.buildingCount))]),n("div",[t._v("教学楼总数")])])])])],1),n("el-col",{attrs:{span:5}},[n("el-card",{attrs:{"body-style":{padding:"0px"}}},[n("div",{staticClass:"status-wrapper"},[n("div",{staticClass:"status-icon",staticStyle:{"background-color":"#409eff"}},[n("i",{staticClass:"el-icon-s-grid"})]),n("div",{staticClass:"status-number"},[n("div",{staticStyle:{color:"#409eff"}},[t._v(t._s(t.status.classroomCount))]),n("div",[t._v("教室总数")])])])])],1)],1)],1)},m=[],h=n("b775");function b(){return Object(h["a"])({url:"/dashboard",method:"GET"})}var v={name:"Dashboard",data:function(){return{status:{userCount:0,buildingCount:0,classroomCount:0}}},methods:{fetchStatus:function(){var t=this;b().then((function(e){t.status=e.data}))}},mounted:function(){this.fetchStatus()}},g=v,k=(n("3695"),Object(i["a"])(g,p,m,!1,null,"136d8e1a",null)),w=k.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{attrs:{id:"basic-layout"}},[n("el-aside",{style:{minWidth:t.collapse?"unset":"200px",width:"auto"},attrs:{id:"aside"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.collapse,expression:"!collapse"}],attrs:{id:"logo"}},[t._v(" Classroom ")]),n("Menu",{attrs:{collapse:t.collapse}})],1),n("el-container",{attrs:{id:"sub"}},[n("el-header",{attrs:{id:"header"}},[n("div",{attrs:{id:"trigger"},on:{click:function(e){t.collapse=!t.collapse}}},[n("i",{class:t.collapse?"el-icon-s-unfold":"el-icon-s-fold"})]),n("div",{attrs:{id:"user-info"}},[n("el-avatar",{attrs:{src:t.avatar,id:"avatar"}}),n("el-dropdown",{on:{command:t.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[t._v(" "+t._s(t.name)),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"logout"}},[t._v("退出登录")])],1)],1)],1)]),n("el-scrollbar",{attrs:{id:"scrollbar"}},[n("el-backtop",{attrs:{target:".el-scrollbar__wrap"}},[n("div",{staticStyle:{"{\n            height":"100%",width:"100%","background-color":"#ecf8f3","box-shadow":"0 0 6px rgba(0,0,0, .12)","text-align":"center","line-height":"40px",color:"#41b883"}},[t._v(" UP ")])]),n("el-main",{staticClass:"main-container"},[n("router-view")],1)],1)],1)],1)},_=[],x=n("5530"),O=n("2f62"),j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-menu",{attrs:{collapse:t.collapse,"collapse-transition":!1,"background-color":"#35495e","text-color":"#fff","active-text-color":"#4fc08d","default-active":t.$route.path,router:""}},[t._l(t.routes,(function(e,r){return[e.children?n("el-submenu",{key:r,attrs:{index:e.path}},[n("template",{slot:"title"},[n("i",{class:e.meta.icon}),n("span",[t._v(t._s(e.meta.title))])]),t._l(e.children,(function(e,r){return n("el-menu-item",{key:r,attrs:{index:e.path}},[t._v(t._s(e.meta.title)+" ")])}))],2):n("el-menu-item",{key:r,attrs:{index:e.path}},[n("i",{class:e.meta.icon}),n("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.meta.title))])])]}))],2)},E=[],C={name:"Menu",props:["collapse"],computed:{routes:function(){return this.$router.options.routes[1].children}}},S=C,T=(n("da6c"),Object(i["a"])(S,j,E,!1,null,"94757cd6",null)),P=T.exports,M={name:"BasicLayout",components:{Menu:P},data:function(){return{collapse:!1}},methods:{handleCommand:function(t){var e=this;"logout"===t&&this.$store.dispatch("user/logout").then((function(){e.$router.push("/login"),e.$message.success("注销成功")}))}},computed:Object(x["a"])({},Object(O["b"])(["avatar","name"]))},A=M,$=(n("02ab"),Object(i["a"])(A,y,_,!1,null,"65f24f04",null)),L=$.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-view")},I=[],N={name:"EmptyLayout"},D=N,R=Object(i["a"])(D,B,I,!1,null,null,null),U=R.exports;r["default"].use(f["a"]);var q=[{path:"/login",name:"Login",component:function(){return n.e("chunk-00232c79").then(n.bind(null,"a55b"))},meta:{title:"登录"}},{path:"/",component:L,redirect:"/dashboard",children:[{path:"/dashboard",name:"Dashboard",component:w,meta:{title:"仪表盘",icon:"el-icon-s-marketing"}},{path:"/cms",component:U,meta:{title:"教室管理",icon:"el-icon-s-home"},children:[{path:"/cms/building",name:"Building",component:function(){return n.e("chunk-7dd641a2").then(n.bind(null,"cde9"))},meta:{title:"教学楼管理"}},{path:"/cms/classroom",name:"Classroom",component:function(){return n.e("chunk-46007864").then(n.bind(null,"78aa"))},meta:{title:"教室管理"}}]},{path:"/sys",component:U,meta:{title:"系统管理",icon:"el-icon-setting"},children:[{path:"/sys/user",name:"User",component:function(){return n.e("chunk-70237052").then(n.bind(null,"45d1"))},meta:{title:"用户管理"}}]}]}],G=new f["a"]({routes:q}),H=G,J=n("4360"),K=(n("c975"),n("b0c0"),n("96cf"),n("1da1")),V=n("323e"),z=n.n(V),F=(n("a5d8"),n("5f87")),W=["/login"];z.a.configure({showSpinner:!1}),H.beforeEach(function(){var t=Object(K["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(z.a.start(),e.meta.title?document.title="".concat(e.meta.title," | cms"):document.title="cms",o=Object(F["a"])(),!o){t.next=30;break}if("/login"!==e.path){t.next=10;break}r("/"),a["Message"].info("已登录"),z.a.done(),t.next=28;break;case 10:if(c=J["a"].getters.name,!c){t.next=15;break}r(),t.next=28;break;case 15:return t.prev=15,t.next=18,J["a"].dispatch("user/getInfo");case 18:r(),t.next=28;break;case 21:return t.prev=21,t.t0=t["catch"](15),t.next=25,J["a"].dispatch("user/logout");case 25:a["Message"].error(t.t0||"Has Error"),r("/login?redirect=".concat(e.path)),z.a.done();case 28:t.next=31;break;case 30:-1!==W.indexOf(e.path)?r():(r("/login?redirect=".concat(e.path)),a["Message"].warning("请登录"),z.a.done());case 31:case"end":return t.stop()}}),t,null,[[15,21]])})));return function(e,n,r){return t.apply(this,arguments)}}()),H.afterEach((function(){z.a.done()})),r["default"].use(o.a),r["default"].config.productionTip=!1,new r["default"]({router:H,store:J["a"],render:function(t){return t(d)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";n("9c0c")},"5f87":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return c}));var r="cms_user_token";function a(){return localStorage.getItem(r)}function o(t){localStorage.setItem(r,t)}function c(){localStorage.removeItem(r)}},"8dd6":function(t,e,n){},"9c0c":function(t,e,n){},a83d:function(t,e,n){},a910:function(t,e,n){},b775:function(t,e,n){"use strict";n("d3b7");var r=n("5530"),a=n("bc3a"),o=n.n(a),c=n("5c96"),s=n("4360"),i=o.a.create({baseURL:"/api",timeout:5e3});i.interceptors.request.use((function(t){var e=Object(r["a"])({},t);return s["a"].getters.token&&(e.headers.Authorization="Bearer ".concat(s["a"].getters.token)),e}),(function(t){return console.log(t),Promise.reject(t)})),i.interceptors.response.use((function(t){var e=t.data;return 200===e.code?e:(401===e.code&&c["MessageBox"].confirm("您的token已过期，可以取消停留在此页面上，或者重新登录","确认注销",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then((function(){s["a"].dispatch("user/logout").then((function(){document.location.reload()}))})),Promise.reject(new Error(e.message||"Error")))}),(function(t){return console.log(t),c["Message"].error(t.message),Promise.reject(t)})),e["a"]=i},c24f:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return c}));var r=n("b775");function a(){return Object(r["a"])({url:"/user",method:"GET"})}function o(t){return Object(r["a"])({url:"/login",method:"POST",data:t})}function c(){return Object(r["a"])({url:"/userInfo",method:"GET"})}},da6c:function(t,e,n){"use strict";n("a910")},f9ed:function(t,e,n){}});
//# sourceMappingURL=app.cd15502f.js.map